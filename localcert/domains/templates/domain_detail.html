{% include "page_start.html" %}

<style>
  table th, table td {
    padding: 1em;
    border: 1px solid #aaa;
  }
</style>

{% include "page_head_end.html" %}

<h3>Records for {{ domain.name }}</h3>

<table>
    <tr>
        <th>rrname</th>
        <th>TTL</th>
        <th>type</th>
        <th>Content</th>
    </tr>
    {% for rrset in rrsets %}
    {% if rrset.type != "SOA" %}
    <tr class="{{ rrset.type }}">
        <td>
            {{ rrset.name }}
        </td>
        <td>
            {{ rrset.ttl }}
        </td>
        <td>
            {{ rrset.type }}
        </td>
        <td>
            <ul>
            {% for record in rrset.records %}
                <p>
                {{ record.content }}
                <form action="{% url 'modify_rrset' rr_name=rrset.name %}"
                      method="post">
                    {% csrf_token %}
                    <input type="hidden" name="rr_type" value="TXT">
                    <input type="hidden" name="rr_content" value="{{ record.content }}">
                    <input type="hidden" name="edit_action" value="remove">
                    <input 
                      type="submit" 
                      {% if rrset.type != "TXT" %}
                        disabled
                        title="Cannot delete"
                      {% endif %}
                      value="x">
                </form>
                </p>
            {% endfor %}
            </ul>
        </td>
    </tr>
    {% endif %}
    {% endfor %}
</table>

{% if can_add_records %}
<a href="{% url 'create_resource_record_page' zone_name=domain.name%}">Add Record</a>
{% endif %}

<h2>API Keys</h2>

The following API keys are scoped to this domain.

<table>
    <tr>
        <th>Key ID</th>
        <th>Last Used</th>
        <th>Created</th>
        <th>Delete</th>
    </tr>
    {% for key in keys %}
      <tr>
        <td>{{key.id}}</td>
        <td>{{key.last_used}}</td>
        <td>{{key.created}}</td>
        <td>
          <form action="{% url 'delete_zone_api_key' zone_name=domain.name %}" method="post">
            {% csrf_token %}
            <input name="secret_key_id" type="text" hidden value="{{ key.id }}">
            <input type="submit" value="x">
          </form>
        </td>
      </tr>
    {% endfor %}
</table>

{% if can_create_api_key %}
<form action="{% url 'create_zone_api_key' zone_name=domain.name %}" method="post">
  {% csrf_token %}
  <input type="submit" value="Create new API key">
</form>
{% endif %}

<p>
<i>Domain active since {{domain.created}}</i>
</p>

<hr style="margin: 4em 0em 4em;">

<p>
The free tier allows you to create up to <b>three subdomains</b>.
This matches the certificate limits of <a href="TODO link here">ZeroSSL</a>'s Free plan.
You may try to use Let's Encrypt, although our domain is currently limited to 50 certificates per week <i>shared across all users</i>, so this may not work for you.
</p>

<p>
In the short term, if you need more than three certificates purchase a Basic <a href="TODO link here">ZeroSSL</a> account and <a href="TODO contact">Contact Us</a>.
</p>

<p>
Once our Let's Encrypt limit has increased, we will greatly increase the subdomain limits for our free tier customers.
Thank you for your patience.
</p>

<p><i>
Referral notice: The ZeroSSL links above contain affiliate codes, and we receive a commission if you subscribe using our links.
ZeroSSL is a great service for customers needing additional certificates beyond what Let's Encrypt offers.
Any commissions we receive help us offset hosting costs for our free tier.
</i></p>

{% include "page_end.html" %}